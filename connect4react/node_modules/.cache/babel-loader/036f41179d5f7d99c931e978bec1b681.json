{"ast":null,"code":"import _createForOfIteratorHelper from\"/Users/madhavramesh/Desktop/Brown University/Connect 4 React/connect4react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _slicedToArray from\"/Users/madhavramesh/Desktop/Brown University/Connect 4 React/connect4react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useRef,useEffect,useState}from\"react\";import{AwesomeButton}from\"react-awesome-button\";import\"react-awesome-button/dist/styles.css\";import Popup from\"react-popup\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Canvas(props){var canvas;var canvasWidth=props.canvasWidth;var canvasHeight=props.canvasHeight;var canvasRef=useRef(null);var drawRegionLeft=props.drawRegionLeft;var drawRegionRight=props.drawRegionRight;var drawRegionTop=props.drawRegionTop;var drawRegionBottom=props.drawRegionBottom;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),chipCoords=_useState2[0],setChipCoords=_useState2[1];var chipsPerRow=7;var chipsPerCol=6;var chipRad=50;var defaultColor=\"#DCDCDC\";var redChipColor=\"#900000\";var yellowChipColor=\"#fbec5d\";var newDrawRegionLeft=drawRegionLeft-chipRad-40;var newDrawRegionTop=drawRegionTop-chipRad-40;var w=drawRegionRight-drawRegionLeft+2*(chipRad+40);var h=drawRegionBottom-drawRegionTop+2*(chipRad+40);var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),player=_useState4[0],setPlayer=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),mouseX=_useState6[0],setMouseX=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),mouseY=_useState8[0],setMouseY=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),win=_useState10[0],setWin=_useState10[1];var setUp=function setUp(ctx){ctx.fillStyle=defaultColor;ctx.fillRect(0,0,canvasWidth,canvasHeight);var newChipCoords=chipCoords;// prettier-ignore\nfor(var i=drawRegionLeft;i<=drawRegionRight;i+=(drawRegionRight-drawRegionLeft)/(chipsPerRow-1)){var row=[];for(var j=drawRegionTop;j<=drawRegionBottom;j+=(drawRegionBottom-drawRegionTop)/(chipsPerCol-1)){row.push([i,j,defaultColor]);}newChipCoords.push(row);}setChipCoords(newChipCoords);};// prettier-ignore\nvar drawBoard=function drawBoard(ctx,color,topLeftX,topLeftY,w,h){ctx.fillStyle=color;ctx.fillRect(topLeftX,topLeftY,w,h);};var drawChips=function drawChips(ctx){var _iterator=_createForOfIteratorHelper(chipCoords),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var col=_step.value;var _iterator2=_createForOfIteratorHelper(col),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var row=_step2.value;drawChip(ctx,row[2],row[0],row[1],chipRad);}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}}}catch(err){_iterator.e(err);}finally{_iterator.f();}};var drawChip=function drawChip(ctx,color,x,y){ctx.fillStyle=color;ctx.beginPath();ctx.arc(x,y,chipRad,0,2*Math.PI);ctx.fill();ctx.stroke();};// prettier-ignore\nvar drop=function drop(chipColor,clickX,clickY){var newChipCoords=chipCoords;var newDrawRegionRight=newDrawRegionLeft+w;var newDrawRegionBottom=newDrawRegionTop+h;for(var i=newDrawRegionLeft;i<newDrawRegionRight;i+=(newDrawRegionRight-newDrawRegionLeft)/(chipsPerRow-1)){var leftBoundary=i;var rightBoundary=i+(newDrawRegionRight-newDrawRegionLeft)/(chipsPerRow-1);if(clickX>=leftBoundary&&clickX<rightBoundary&&clickY>=newDrawRegionTop&&clickY<=newDrawRegionBottom){console.log(\"Click confirmed\");var col=Math.floor((clickX-newDrawRegionLeft)/w*chipsPerRow);var row=chipCoords[col].length-1;for(var j=0;j<chipCoords[col].length;j++){if(chipCoords[col][j][2]!==defaultColor){row=j-1;break;}}if(row>=0){newChipCoords[col][row][2]=chipColor;}}}setChipCoords(newChipCoords);};var mousePosOnCanvas=function mousePosOnCanvas(x,y){var canvas=canvasRef.current;var rect=canvas.getBoundingClientRect();var scaleX=canvas.width/rect.width;var scaleY=canvas.height/rect.height;return{x:(x-rect.left)*scaleX,y:(y-rect.top)*scaleY};};var handleMouseDown=function handleMouseDown(event){event.preventDefault();event.stopPropagation();var mousePos=mousePosOnCanvas(event.clientX,event.clientY);setMouseX(mousePos[\"x\"]);setMouseY(mousePos[\"y\"]);};var handleMouseUp=function handleMouseUp(event){event.preventDefault();event.stopPropagation();var curMousePos=mousePosOnCanvas(event.clientX,event.clientY);var curMouseX=curMousePos[\"x\"];var curMouseY=curMousePos[\"y\"];var dx=curMouseX-mouseX;var dy=curMouseY-mouseY;if(dx>0.1||dy>0.1){return;}if(player===0){drop(redChipColor,mouseX,mouseY);setPlayer(1);}else if(player===1){drop(yellowChipColor,mouseX,mouseY);setPlayer(0);}};// prettier-ignore\nvar calculateWin=function calculateWin(){// vertical win\nfor(var i=0;i<chipCoords.length;i++){for(var j=0;j<chipCoords[i].length-3;j++){if(chipCoords[i][j][2]===chipCoords[i][j+1][2]&&chipCoords[i][j+1][2]===chipCoords[i][j+2][2]&&chipCoords[i][j+2][2]===chipCoords[i][j+3][2]&&chipCoords[i][j][2]!==defaultColor){setWin(true);}}}// horizontal win\nfor(var _i=0;_i<chipCoords.length-3;_i++){for(var _j=0;_j<chipCoords[_i].length;_j++){if(chipCoords[_i][_j][2]===chipCoords[_i+1][_j][2]&&chipCoords[_i+1][_j][2]===chipCoords[_i+2][_j][2]&&chipCoords[_i+2][_j][2]===chipCoords[_i+3][_j][2]&&chipCoords[_i][_j][2]!==defaultColor){setWin(true);}}}// descending diagonal\nfor(var _i2=3;_i2<chipCoords.length;_i2++){for(var _j2=3;_j2<chipCoords[_i2].length;_j2++){if(chipCoords[_i2][_j2][2]===chipCoords[_i2-1][_j2-1][2]&&chipCoords[_i2-1][_j2-1][2]===chipCoords[_i2-2][_j2-2][2]&&chipCoords[_i2-2][_j2-2][2]===chipCoords[_i2-3][_j2-3][2]&&chipCoords[_i2][_j2][2]!==defaultColor){setWin(true);}}}// ascending diagonal\nfor(var _i3=0;_i3<chipCoords.length-3;_i3++){for(var _j3=3;_j3<chipCoords[_i3].length;_j3++){if(chipCoords[_i3][_j3][2]===chipCoords[_i3+1][_j3-1][2]&&chipCoords[_i3+1][_j3-1][2]===chipCoords[_i3+2][_j3-2][2]&&chipCoords[_i3+2][_j3-2][2]===chipCoords[_i3+3][_j3-3][2]&&chipCoords[_i3][_j3][2]!==defaultColor){setWin(true);}}}};// prettier-ignore\nvar resetChips=function resetChips(){canvas=canvasRef.current;var ctx=canvas.getContext(\"2d\");var newChipCoords=chipCoords;for(var i=0;i<chipCoords.length;i++){for(var j=0;j<chipCoords[i].length;j++){newChipCoords[i][j][2]=defaultColor;}}setChipCoords(newChipCoords);setWin(false);console.log(chipCoords);};useEffect(function(){canvas=canvasRef.current;var ctx=canvas.getContext(\"2d\");setUp(ctx);drawBoard(ctx,\"#0099FF\",newDrawRegionLeft,newDrawRegionTop,w,h);},[]);useEffect(function(){canvas=canvasRef.current;var ctx=canvas.getContext(\"2d\");console.log(\"Redrawing...\");if(!win){drawChips(ctx);calculateWin();}else{console.log(\"WINNER\");}},[drawChips]);return/*#__PURE__*/_jsxs(\"div\",{className:\"canvas\",children:[/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef,width:canvasWidth,height:canvasHeight,onMouseDown:handleMouseDown,onMouseUp:handleMouseUp}),/*#__PURE__*/_jsx(AwesomeButton,{type:\"primary\",onPress:function onPress(){return resetChips();},children:\"Clear Board\"})]});}export default Canvas;","map":{"version":3,"sources":["/Users/madhavramesh/Desktop/Brown University/Connect 4 React/connect4react/src/Canvas.js"],"names":["React","useRef","useEffect","useState","AwesomeButton","Popup","Canvas","props","canvas","canvasWidth","canvasHeight","canvasRef","drawRegionLeft","drawRegionRight","drawRegionTop","drawRegionBottom","chipCoords","setChipCoords","chipsPerRow","chipsPerCol","chipRad","defaultColor","redChipColor","yellowChipColor","newDrawRegionLeft","newDrawRegionTop","w","h","player","setPlayer","mouseX","setMouseX","mouseY","setMouseY","win","setWin","setUp","ctx","fillStyle","fillRect","newChipCoords","i","row","j","push","drawBoard","color","topLeftX","topLeftY","drawChips","col","drawChip","x","y","beginPath","arc","Math","PI","fill","stroke","drop","chipColor","clickX","clickY","newDrawRegionRight","newDrawRegionBottom","leftBoundary","rightBoundary","console","log","floor","length","mousePosOnCanvas","current","rect","getBoundingClientRect","scaleX","width","scaleY","height","left","top","handleMouseDown","event","preventDefault","stopPropagation","mousePos","clientX","clientY","handleMouseUp","curMousePos","curMouseX","curMouseY","dx","dy","calculateWin","resetChips","getContext"],"mappings":"0ZAAA,MAAOA,CAAAA,KAAP,EAAgBC,MAAhB,CAAwBC,SAAxB,CAAmCC,QAAnC,KAAmD,OAAnD,CACA,OAASC,aAAT,KAA8B,sBAA9B,CACA,MAAO,sCAAP,CACA,MAAOC,CAAAA,KAAP,KAAkB,aAAlB,C,wFAEA,QAASC,CAAAA,MAAT,CAAgBC,KAAhB,CAAuB,CACrB,GAAIC,CAAAA,MAAJ,CACA,GAAMC,CAAAA,WAAW,CAAGF,KAAK,CAACE,WAA1B,CACA,GAAMC,CAAAA,YAAY,CAAGH,KAAK,CAACG,YAA3B,CACA,GAAMC,CAAAA,SAAS,CAAGV,MAAM,CAAC,IAAD,CAAxB,CAEA,GAAMW,CAAAA,cAAc,CAAGL,KAAK,CAACK,cAA7B,CACA,GAAMC,CAAAA,eAAe,CAAGN,KAAK,CAACM,eAA9B,CACA,GAAMC,CAAAA,aAAa,CAAGP,KAAK,CAACO,aAA5B,CACA,GAAMC,CAAAA,gBAAgB,CAAGR,KAAK,CAACQ,gBAA/B,CATqB,cAWeZ,QAAQ,CAAC,EAAD,CAXvB,wCAWda,UAXc,eAWFC,aAXE,eAYrB,GAAMC,CAAAA,WAAW,CAAG,CAApB,CACA,GAAMC,CAAAA,WAAW,CAAG,CAApB,CACA,GAAMC,CAAAA,OAAO,CAAG,EAAhB,CAEA,GAAMC,CAAAA,YAAY,CAAG,SAArB,CACA,GAAMC,CAAAA,YAAY,CAAG,SAArB,CACA,GAAMC,CAAAA,eAAe,CAAG,SAAxB,CAEA,GAAMC,CAAAA,iBAAiB,CAAGZ,cAAc,CAAGQ,OAAjB,CAA2B,EAArD,CACA,GAAMK,CAAAA,gBAAgB,CAAGX,aAAa,CAAGM,OAAhB,CAA0B,EAAnD,CACA,GAAMM,CAAAA,CAAC,CAAGb,eAAe,CAAGD,cAAlB,CAAmC,GAAKQ,OAAO,CAAG,EAAf,CAA7C,CACA,GAAMO,CAAAA,CAAC,CAAGZ,gBAAgB,CAAGD,aAAnB,CAAmC,GAAKM,OAAO,CAAG,EAAf,CAA7C,CAvBqB,eAyBOjB,QAAQ,CAAC,CAAD,CAzBf,yCAyBdyB,MAzBc,eAyBNC,SAzBM,8BA0BO1B,QAAQ,CAAC,CAAD,CA1Bf,yCA0Bd2B,MA1Bc,eA0BNC,SA1BM,8BA2BO5B,QAAQ,CAAC,CAAD,CA3Bf,yCA2Bd6B,MA3Bc,eA2BNC,SA3BM,8BA6BC9B,QAAQ,CAAC,KAAD,CA7BT,0CA6Bd+B,GA7Bc,gBA6BTC,MA7BS,gBA+BrB,GAAMC,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,CAACC,GAAD,CAAS,CACrBA,GAAG,CAACC,SAAJ,CAAgBjB,YAAhB,CACAgB,GAAG,CAACE,QAAJ,CAAa,CAAb,CAAgB,CAAhB,CAAmB9B,WAAnB,CAAgCC,YAAhC,EAEA,GAAM8B,CAAAA,aAAa,CAAGxB,UAAtB,CACA;AACA,IAAK,GAAIyB,CAAAA,CAAC,CAAG7B,cAAb,CAA6B6B,CAAC,EAAI5B,eAAlC,CAAmD4B,CAAC,EAAI,CAAC5B,eAAe,CAAGD,cAAnB,GAAsCM,WAAW,CAAG,CAApD,CAAxD,CAAgH,CAC9G,GAAMwB,CAAAA,GAAG,CAAG,EAAZ,CACA,IAAK,GAAIC,CAAAA,CAAC,CAAG7B,aAAb,CAA4B6B,CAAC,EAAI5B,gBAAjC,CAAmD4B,CAAC,EAAI,CAAC5B,gBAAgB,CAAGD,aAApB,GAAsCK,WAAW,CAAG,CAApD,CAAxD,CAAgH,CAC9GuB,GAAG,CAACE,IAAJ,CAAS,CAACH,CAAD,CAAIE,CAAJ,CAAOtB,YAAP,CAAT,EACD,CACDmB,aAAa,CAACI,IAAd,CAAmBF,GAAnB,EACD,CACDzB,aAAa,CAACuB,aAAD,CAAb,CACD,CAdD,CAgBA;AACA,GAAMK,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAACR,GAAD,CAAMS,KAAN,CAAaC,QAAb,CAAuBC,QAAvB,CAAiCtB,CAAjC,CAAoCC,CAApC,CAA0C,CAC1DU,GAAG,CAACC,SAAJ,CAAgBQ,KAAhB,CACAT,GAAG,CAACE,QAAJ,CAAaQ,QAAb,CAAuBC,QAAvB,CAAiCtB,CAAjC,CAAoCC,CAApC,EACD,CAHD,CAKA,GAAMsB,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAACZ,GAAD,CAAS,0CACPrB,UADO,YACzB,+CAA8B,IAAnBkC,CAAAA,GAAmB,uDACVA,GADU,aAC5B,kDAAuB,IAAZR,CAAAA,GAAY,cACrBS,QAAQ,CAACd,GAAD,CAAMK,GAAG,CAAC,CAAD,CAAT,CAAcA,GAAG,CAAC,CAAD,CAAjB,CAAsBA,GAAG,CAAC,CAAD,CAAzB,CAA8BtB,OAA9B,CAAR,CACD,CAH2B,uDAI7B,CALwB,qDAM1B,CAND,CAQA,GAAM+B,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACd,GAAD,CAAMS,KAAN,CAAaM,CAAb,CAAgBC,CAAhB,CAAsB,CACrChB,GAAG,CAACC,SAAJ,CAAgBQ,KAAhB,CACAT,GAAG,CAACiB,SAAJ,GACAjB,GAAG,CAACkB,GAAJ,CAAQH,CAAR,CAAWC,CAAX,CAAcjC,OAAd,CAAuB,CAAvB,CAA0B,EAAIoC,IAAI,CAACC,EAAnC,EACApB,GAAG,CAACqB,IAAJ,GACArB,GAAG,CAACsB,MAAJ,GACD,CAND,CAQA;AACA,GAAMC,CAAAA,IAAI,CAAG,QAAPA,CAAAA,IAAO,CAACC,SAAD,CAAYC,MAAZ,CAAoBC,MAApB,CAA+B,CAC1C,GAAMvB,CAAAA,aAAa,CAAGxB,UAAtB,CAEA,GAAMgD,CAAAA,kBAAkB,CAAGxC,iBAAiB,CAAGE,CAA/C,CACA,GAAMuC,CAAAA,mBAAmB,CAAGxC,gBAAgB,CAAGE,CAA/C,CAEA,IAAK,GAAIc,CAAAA,CAAC,CAAGjB,iBAAb,CAAgCiB,CAAC,CAAGuB,kBAApC,CAAwDvB,CAAC,EAAI,CAACuB,kBAAkB,CAAGxC,iBAAtB,GAA4CN,WAAW,CAAG,CAA1D,CAA7D,CAA2H,CACzH,GAAMgD,CAAAA,YAAY,CAAGzB,CAArB,CACA,GAAM0B,CAAAA,aAAa,CAAG1B,CAAC,CAAG,CAACuB,kBAAkB,CAAGxC,iBAAtB,GAA4CN,WAAW,CAAG,CAA1D,CAA1B,CACA,GAAI4C,MAAM,EAAII,YAAV,EAA0BJ,MAAM,CAAGK,aAAnC,EAAoDJ,MAAM,EAAItC,gBAA9D,EAAkFsC,MAAM,EAAIE,mBAAhG,CAAqH,CACnHG,OAAO,CAACC,GAAR,CAAY,iBAAZ,EACA,GAAInB,CAAAA,GAAG,CAAGM,IAAI,CAACc,KAAL,CAAW,CAACR,MAAM,CAAGtC,iBAAV,EAA+BE,CAA/B,CAAmCR,WAA9C,CAAV,CACA,GAAIwB,CAAAA,GAAG,CAAG1B,UAAU,CAACkC,GAAD,CAAV,CAAgBqB,MAAhB,CAAyB,CAAnC,CAEA,IAAK,GAAI5B,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAG3B,UAAU,CAACkC,GAAD,CAAV,CAAgBqB,MAApC,CAA4C5B,CAAC,EAA7C,CAAiD,CAC/C,GAAI3B,UAAU,CAACkC,GAAD,CAAV,CAAgBP,CAAhB,EAAmB,CAAnB,IAA0BtB,YAA9B,CAA4C,CAC1CqB,GAAG,CAAGC,CAAC,CAAG,CAAV,CACA,MACD,CACF,CACD,GAAID,GAAG,EAAI,CAAX,CAAc,CACZF,aAAa,CAACU,GAAD,CAAb,CAAmBR,GAAnB,EAAwB,CAAxB,EAA6BmB,SAA7B,CACD,CACF,CACF,CACD5C,aAAa,CAACuB,aAAD,CAAb,CACD,CA1BD,CA4BA,GAAMgC,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,CAACpB,CAAD,CAAIC,CAAJ,CAAU,CACjC,GAAM7C,CAAAA,MAAM,CAAGG,SAAS,CAAC8D,OAAzB,CACA,GAAMC,CAAAA,IAAI,CAAGlE,MAAM,CAACmE,qBAAP,EAAb,CACA,GAAMC,CAAAA,MAAM,CAAGpE,MAAM,CAACqE,KAAP,CAAeH,IAAI,CAACG,KAAnC,CACA,GAAMC,CAAAA,MAAM,CAAGtE,MAAM,CAACuE,MAAP,CAAgBL,IAAI,CAACK,MAApC,CAEA,MAAO,CACL3B,CAAC,CAAE,CAACA,CAAC,CAAGsB,IAAI,CAACM,IAAV,EAAkBJ,MADhB,CAELvB,CAAC,CAAE,CAACA,CAAC,CAAGqB,IAAI,CAACO,GAAV,EAAiBH,MAFf,CAAP,CAID,CAVD,CAYA,GAAMI,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACC,KAAD,CAAW,CACjCA,KAAK,CAACC,cAAN,GACAD,KAAK,CAACE,eAAN,GAEA,GAAMC,CAAAA,QAAQ,CAAGd,gBAAgB,CAACW,KAAK,CAACI,OAAP,CAAgBJ,KAAK,CAACK,OAAtB,CAAjC,CACAzD,SAAS,CAACuD,QAAQ,CAAC,GAAD,CAAT,CAAT,CACArD,SAAS,CAACqD,QAAQ,CAAC,GAAD,CAAT,CAAT,CACD,CAPD,CASA,GAAMG,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACN,KAAD,CAAW,CAC/BA,KAAK,CAACC,cAAN,GACAD,KAAK,CAACE,eAAN,GAEA,GAAMK,CAAAA,WAAW,CAAGlB,gBAAgB,CAACW,KAAK,CAACI,OAAP,CAAgBJ,KAAK,CAACK,OAAtB,CAApC,CACA,GAAMG,CAAAA,SAAS,CAAGD,WAAW,CAAC,GAAD,CAA7B,CACA,GAAME,CAAAA,SAAS,CAAGF,WAAW,CAAC,GAAD,CAA7B,CACA,GAAMG,CAAAA,EAAE,CAAGF,SAAS,CAAG7D,MAAvB,CACA,GAAMgE,CAAAA,EAAE,CAAGF,SAAS,CAAG5D,MAAvB,CAEA,GAAI6D,EAAE,CAAG,GAAL,EAAYC,EAAE,CAAG,GAArB,CAA0B,CACxB,OACD,CAED,GAAIlE,MAAM,GAAK,CAAf,CAAkB,CAChBgC,IAAI,CAACtC,YAAD,CAAeQ,MAAf,CAAuBE,MAAvB,CAAJ,CACAH,SAAS,CAAC,CAAD,CAAT,CACD,CAHD,IAGO,IAAID,MAAM,GAAK,CAAf,CAAkB,CACvBgC,IAAI,CAACrC,eAAD,CAAkBO,MAAlB,CAA0BE,MAA1B,CAAJ,CACAH,SAAS,CAAC,CAAD,CAAT,CACD,CACF,CArBD,CAuBA;AACA,GAAMkE,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACzB;AACA,IAAK,GAAItD,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAGzB,UAAU,CAACuD,MAA/B,CAAuC9B,CAAC,EAAxC,CAA4C,CAC1C,IAAK,GAAIE,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAG3B,UAAU,CAACyB,CAAD,CAAV,CAAc8B,MAAd,CAAuB,CAA3C,CAA8C5B,CAAC,EAA/C,CAAmD,CACjD,GAAI3B,UAAU,CAACyB,CAAD,CAAV,CAAcE,CAAd,EAAiB,CAAjB,IAAwB3B,UAAU,CAACyB,CAAD,CAAV,CAAcE,CAAC,CAAG,CAAlB,EAAqB,CAArB,CAAxB,EACD3B,UAAU,CAACyB,CAAD,CAAV,CAAcE,CAAC,CAAG,CAAlB,EAAqB,CAArB,IAA4B3B,UAAU,CAACyB,CAAD,CAAV,CAAcE,CAAC,CAAG,CAAlB,EAAqB,CAArB,CAD3B,EAED3B,UAAU,CAACyB,CAAD,CAAV,CAAcE,CAAC,CAAG,CAAlB,EAAqB,CAArB,IAA4B3B,UAAU,CAACyB,CAAD,CAAV,CAAcE,CAAC,CAAG,CAAlB,EAAqB,CAArB,CAF3B,EAGD3B,UAAU,CAACyB,CAAD,CAAV,CAAcE,CAAd,EAAiB,CAAjB,IAAwBtB,YAH3B,CAGyC,CACvCc,MAAM,CAAC,IAAD,CAAN,CACD,CACF,CACF,CAED;AACA,IAAK,GAAIM,CAAAA,EAAC,CAAG,CAAb,CAAgBA,EAAC,CAAGzB,UAAU,CAACuD,MAAX,CAAoB,CAAxC,CAA2C9B,EAAC,EAA5C,CAAgD,CAC9C,IAAK,GAAIE,CAAAA,EAAC,CAAG,CAAb,CAAgBA,EAAC,CAAG3B,UAAU,CAACyB,EAAD,CAAV,CAAc8B,MAAlC,CAA0C5B,EAAC,EAA3C,CAA+C,CAC7C,GAAI3B,UAAU,CAACyB,EAAD,CAAV,CAAcE,EAAd,EAAiB,CAAjB,IAAwB3B,UAAU,CAACyB,EAAC,CAAC,CAAH,CAAV,CAAgBE,EAAhB,EAAmB,CAAnB,CAAxB,EACG3B,UAAU,CAACyB,EAAC,CAAC,CAAH,CAAV,CAAgBE,EAAhB,EAAmB,CAAnB,IAA0B3B,UAAU,CAACyB,EAAC,CAAC,CAAH,CAAV,CAAgBE,EAAhB,EAAmB,CAAnB,CAD7B,EAEG3B,UAAU,CAACyB,EAAC,CAAC,CAAH,CAAV,CAAgBE,EAAhB,EAAmB,CAAnB,IAA0B3B,UAAU,CAACyB,EAAC,CAAC,CAAH,CAAV,CAAgBE,EAAhB,EAAmB,CAAnB,CAF7B,EAGG3B,UAAU,CAACyB,EAAD,CAAV,CAAcE,EAAd,EAAiB,CAAjB,IAAwBtB,YAH/B,CAG6C,CAC3Cc,MAAM,CAAC,IAAD,CAAN,CACD,CACF,CACF,CAED;AACA,IAAK,GAAIM,CAAAA,GAAC,CAAG,CAAb,CAAgBA,GAAC,CAAGzB,UAAU,CAACuD,MAA/B,CAAuC9B,GAAC,EAAxC,CAA4C,CAC1C,IAAK,GAAIE,CAAAA,GAAC,CAAG,CAAb,CAAgBA,GAAC,CAAG3B,UAAU,CAACyB,GAAD,CAAV,CAAc8B,MAAlC,CAA0C5B,GAAC,EAA3C,CAA+C,CAC7C,GAAI3B,UAAU,CAACyB,GAAD,CAAV,CAAcE,GAAd,EAAiB,CAAjB,IAAwB3B,UAAU,CAACyB,GAAC,CAAC,CAAH,CAAV,CAAgBE,GAAC,CAAC,CAAlB,EAAqB,CAArB,CAAxB,EACG3B,UAAU,CAACyB,GAAC,CAAC,CAAH,CAAV,CAAgBE,GAAC,CAAC,CAAlB,EAAqB,CAArB,IAA4B3B,UAAU,CAACyB,GAAC,CAAC,CAAH,CAAV,CAAgBE,GAAC,CAAC,CAAlB,EAAqB,CAArB,CAD/B,EAEG3B,UAAU,CAACyB,GAAC,CAAC,CAAH,CAAV,CAAgBE,GAAC,CAAC,CAAlB,EAAqB,CAArB,IAA4B3B,UAAU,CAACyB,GAAC,CAAC,CAAH,CAAV,CAAgBE,GAAC,CAAC,CAAlB,EAAqB,CAArB,CAF/B,EAGG3B,UAAU,CAACyB,GAAD,CAAV,CAAcE,GAAd,EAAiB,CAAjB,IAAwBtB,YAH/B,CAG6C,CAC3Cc,MAAM,CAAC,IAAD,CAAN,CACD,CACF,CACF,CAED;AACA,IAAK,GAAIM,CAAAA,GAAC,CAAG,CAAb,CAAgBA,GAAC,CAAGzB,UAAU,CAACuD,MAAX,CAAoB,CAAxC,CAA2C9B,GAAC,EAA5C,CAAgD,CAC9C,IAAK,GAAIE,CAAAA,GAAC,CAAG,CAAb,CAAgBA,GAAC,CAAG3B,UAAU,CAACyB,GAAD,CAAV,CAAc8B,MAAlC,CAA0C5B,GAAC,EAA3C,CAA+C,CAC7C,GAAI3B,UAAU,CAACyB,GAAD,CAAV,CAAcE,GAAd,EAAiB,CAAjB,IAAwB3B,UAAU,CAACyB,GAAC,CAAC,CAAH,CAAV,CAAgBE,GAAC,CAAC,CAAlB,EAAqB,CAArB,CAAxB,EACG3B,UAAU,CAACyB,GAAC,CAAC,CAAH,CAAV,CAAgBE,GAAC,CAAC,CAAlB,EAAqB,CAArB,IAA4B3B,UAAU,CAACyB,GAAC,CAAC,CAAH,CAAV,CAAgBE,GAAC,CAAC,CAAlB,EAAqB,CAArB,CAD/B,EAEG3B,UAAU,CAACyB,GAAC,CAAC,CAAH,CAAV,CAAgBE,GAAC,CAAC,CAAlB,EAAqB,CAArB,IAA4B3B,UAAU,CAACyB,GAAC,CAAC,CAAH,CAAV,CAAgBE,GAAC,CAAC,CAAlB,EAAqB,CAArB,CAF/B,EAGG3B,UAAU,CAACyB,GAAD,CAAV,CAAcE,GAAd,EAAiB,CAAjB,IAAwBtB,YAH/B,CAG6C,CAC3Cc,MAAM,CAAC,IAAD,CAAN,CACD,CACF,CACF,CACF,CAhDD,CAkDA;AACA,GAAM6D,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CACvBxF,MAAM,CAAGG,SAAS,CAAC8D,OAAnB,CACA,GAAIpC,CAAAA,GAAG,CAAG7B,MAAM,CAACyF,UAAP,CAAkB,IAAlB,CAAV,CAEA,GAAMzD,CAAAA,aAAa,CAAGxB,UAAtB,CACA,IAAK,GAAIyB,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAGzB,UAAU,CAACuD,MAA/B,CAAuC9B,CAAC,EAAxC,CAA4C,CAC1C,IAAK,GAAIE,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAG3B,UAAU,CAACyB,CAAD,CAAV,CAAc8B,MAAlC,CAA0C5B,CAAC,EAA3C,CAA+C,CAC7CH,aAAa,CAACC,CAAD,CAAb,CAAiBE,CAAjB,EAAoB,CAApB,EAAyBtB,YAAzB,CACD,CACF,CACDJ,aAAa,CAACuB,aAAD,CAAb,CACAL,MAAM,CAAC,KAAD,CAAN,CACAiC,OAAO,CAACC,GAAR,CAAYrD,UAAZ,EACD,CAbD,CAeAd,SAAS,CAAC,UAAM,CACdM,MAAM,CAAGG,SAAS,CAAC8D,OAAnB,CACA,GAAIpC,CAAAA,GAAG,CAAG7B,MAAM,CAACyF,UAAP,CAAkB,IAAlB,CAAV,CAEA7D,KAAK,CAACC,GAAD,CAAL,CACAQ,SAAS,CAACR,GAAD,CAAM,SAAN,CAAiBb,iBAAjB,CAAoCC,gBAApC,CAAsDC,CAAtD,CAAyDC,CAAzD,CAAT,CACD,CANQ,CAMN,EANM,CAAT,CAQAzB,SAAS,CAAC,UAAM,CACdM,MAAM,CAAGG,SAAS,CAAC8D,OAAnB,CACA,GAAIpC,CAAAA,GAAG,CAAG7B,MAAM,CAACyF,UAAP,CAAkB,IAAlB,CAAV,CAEA7B,OAAO,CAACC,GAAR,CAAY,cAAZ,EAEA,GAAI,CAACnC,GAAL,CAAU,CACRe,SAAS,CAACZ,GAAD,CAAT,CACA0D,YAAY,GACb,CAHD,IAGO,CACL3B,OAAO,CAACC,GAAR,CAAY,QAAZ,EACD,CACF,CAZQ,CAYN,CAACpB,SAAD,CAZM,CAAT,CAcA,mBACE,aAAK,SAAS,CAAC,QAAf,wBACE,eACE,GAAG,CAAEtC,SADP,CAEE,KAAK,CAAEF,WAFT,CAGE,MAAM,CAAEC,YAHV,CAIE,WAAW,CAAEwE,eAJf,CAKE,SAAS,CAAEO,aALb,EADF,cAQE,KAAC,aAAD,EAAe,IAAI,CAAC,SAApB,CAA8B,OAAO,CAAE,yBAAMO,CAAAA,UAAU,EAAhB,EAAvC,yBARF,GADF,CAcD,CAED,cAAe1F,CAAAA,MAAf","sourcesContent":["import React, { useRef, useEffect, useState } from \"react\";\nimport { AwesomeButton } from \"react-awesome-button\";\nimport \"react-awesome-button/dist/styles.css\";\nimport Popup from \"react-popup\";\n\nfunction Canvas(props) {\n  let canvas;\n  const canvasWidth = props.canvasWidth;\n  const canvasHeight = props.canvasHeight;\n  const canvasRef = useRef(null);\n\n  const drawRegionLeft = props.drawRegionLeft;\n  const drawRegionRight = props.drawRegionRight;\n  const drawRegionTop = props.drawRegionTop;\n  const drawRegionBottom = props.drawRegionBottom;\n\n  const [chipCoords, setChipCoords] = useState([]);\n  const chipsPerRow = 7;\n  const chipsPerCol = 6;\n  const chipRad = 50;\n\n  const defaultColor = \"#DCDCDC\";\n  const redChipColor = \"#900000\";\n  const yellowChipColor = \"#fbec5d\";\n\n  const newDrawRegionLeft = drawRegionLeft - chipRad - 40;\n  const newDrawRegionTop = drawRegionTop - chipRad - 40;\n  const w = drawRegionRight - drawRegionLeft + 2 * (chipRad + 40);\n  const h = drawRegionBottom - drawRegionTop + 2 * (chipRad + 40);\n\n  const [player, setPlayer] = useState(0);\n  const [mouseX, setMouseX] = useState(0);\n  const [mouseY, setMouseY] = useState(0);\n\n  const [win, setWin] = useState(false);\n\n  const setUp = (ctx) => {\n    ctx.fillStyle = defaultColor;\n    ctx.fillRect(0, 0, canvasWidth, canvasHeight);\n\n    const newChipCoords = chipCoords;\n    // prettier-ignore\n    for (let i = drawRegionLeft; i <= drawRegionRight; i += (drawRegionRight - drawRegionLeft) / (chipsPerRow - 1)) {\n      const row = [];\n      for (let j = drawRegionTop; j <= drawRegionBottom; j += (drawRegionBottom - drawRegionTop) / (chipsPerCol - 1)) {\n        row.push([i, j, defaultColor]);\n      }\n      newChipCoords.push(row);\n    }\n    setChipCoords(newChipCoords);\n  };\n\n  // prettier-ignore\n  const drawBoard = (ctx, color, topLeftX, topLeftY, w, h) => {\n    ctx.fillStyle = color;\n    ctx.fillRect(topLeftX, topLeftY, w, h);\n  };\n\n  const drawChips = (ctx) => {\n    for (const col of chipCoords) {\n      for (const row of col) {\n        drawChip(ctx, row[2], row[0], row[1], chipRad);\n      }\n    }\n  };\n\n  const drawChip = (ctx, color, x, y) => {\n    ctx.fillStyle = color;\n    ctx.beginPath();\n    ctx.arc(x, y, chipRad, 0, 2 * Math.PI);\n    ctx.fill();\n    ctx.stroke();\n  };\n\n  // prettier-ignore\n  const drop = (chipColor, clickX, clickY) => {\n    const newChipCoords = chipCoords;\n\n    const newDrawRegionRight = newDrawRegionLeft + w;\n    const newDrawRegionBottom = newDrawRegionTop + h;\n\n    for (let i = newDrawRegionLeft; i < newDrawRegionRight; i += (newDrawRegionRight - newDrawRegionLeft) / (chipsPerRow - 1)) {\n      const leftBoundary = i;\n      const rightBoundary = i + (newDrawRegionRight - newDrawRegionLeft) / (chipsPerRow - 1);\n      if (clickX >= leftBoundary && clickX < rightBoundary && clickY >= newDrawRegionTop && clickY <= newDrawRegionBottom) {\n        console.log(\"Click confirmed\");\n        let col = Math.floor((clickX - newDrawRegionLeft) / w * chipsPerRow);\n        let row = chipCoords[col].length - 1;\n\n        for (let j = 0; j < chipCoords[col].length; j++) {\n          if (chipCoords[col][j][2] !== defaultColor) {\n            row = j - 1;\n            break;\n          }\n        }\n        if (row >= 0) {\n          newChipCoords[col][row][2] = chipColor;\n        }\n      }\n    }\n    setChipCoords(newChipCoords);\n  };\n\n  const mousePosOnCanvas = (x, y) => {\n    const canvas = canvasRef.current;\n    const rect = canvas.getBoundingClientRect();\n    const scaleX = canvas.width / rect.width;\n    const scaleY = canvas.height / rect.height;\n\n    return {\n      x: (x - rect.left) * scaleX,\n      y: (y - rect.top) * scaleY,\n    };\n  };\n\n  const handleMouseDown = (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    const mousePos = mousePosOnCanvas(event.clientX, event.clientY);\n    setMouseX(mousePos[\"x\"]);\n    setMouseY(mousePos[\"y\"]);\n  };\n\n  const handleMouseUp = (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    const curMousePos = mousePosOnCanvas(event.clientX, event.clientY);\n    const curMouseX = curMousePos[\"x\"];\n    const curMouseY = curMousePos[\"y\"];\n    const dx = curMouseX - mouseX;\n    const dy = curMouseY - mouseY;\n\n    if (dx > 0.1 || dy > 0.1) {\n      return;\n    }\n\n    if (player === 0) {\n      drop(redChipColor, mouseX, mouseY);\n      setPlayer(1);\n    } else if (player === 1) {\n      drop(yellowChipColor, mouseX, mouseY);\n      setPlayer(0);\n    }\n  };\n\n  // prettier-ignore\n  const calculateWin = () => {\n    // vertical win\n    for (let i = 0; i < chipCoords.length; i++) {\n      for (let j = 0; j < chipCoords[i].length - 3; j++) {\n        if (chipCoords[i][j][2] === chipCoords[i][j + 1][2]\n        && chipCoords[i][j + 1][2] === chipCoords[i][j + 2][2]\n        && chipCoords[i][j + 2][2] === chipCoords[i][j + 3][2]\n        && chipCoords[i][j][2] !== defaultColor) {\n          setWin(true);\n        }\n      }\n    }\n\n    // horizontal win\n    for (let i = 0; i < chipCoords.length - 3; i++) {\n      for (let j = 0; j < chipCoords[i].length; j++) {\n        if (chipCoords[i][j][2] === chipCoords[i+1][j][2]\n            && chipCoords[i+1][j][2] === chipCoords[i+2][j][2]\n            && chipCoords[i+2][j][2] === chipCoords[i+3][j][2]\n            && chipCoords[i][j][2] !== defaultColor) {\n          setWin(true);\n        }\n      }\n    }\n\n    // descending diagonal\n    for (let i = 3; i < chipCoords.length; i++) {\n      for (let j = 3; j < chipCoords[i].length; j++) {\n        if (chipCoords[i][j][2] === chipCoords[i-1][j-1][2]\n            && chipCoords[i-1][j-1][2] === chipCoords[i-2][j-2][2]\n            && chipCoords[i-2][j-2][2] === chipCoords[i-3][j-3][2]\n            && chipCoords[i][j][2] !== defaultColor) {\n          setWin(true);\n        }\n      }\n    }\n\n    // ascending diagonal\n    for (let i = 0; i < chipCoords.length - 3; i++) {\n      for (let j = 3; j < chipCoords[i].length; j++) {\n        if (chipCoords[i][j][2] === chipCoords[i+1][j-1][2]\n            && chipCoords[i+1][j-1][2] === chipCoords[i+2][j-2][2]\n            && chipCoords[i+2][j-2][2] === chipCoords[i+3][j-3][2]\n            && chipCoords[i][j][2] !== defaultColor) {\n          setWin(true);\n        }\n      }\n    }\n  }\n\n  // prettier-ignore\n  const resetChips = () => {\n    canvas = canvasRef.current;\n    let ctx = canvas.getContext(\"2d\");\n\n    const newChipCoords = chipCoords;\n    for (let i = 0; i < chipCoords.length; i++) {\n      for (let j = 0; j < chipCoords[i].length; j++) {\n        newChipCoords[i][j][2] = defaultColor;\n      }\n    }\n    setChipCoords(newChipCoords);\n    setWin(false);\n    console.log(chipCoords);\n  };\n\n  useEffect(() => {\n    canvas = canvasRef.current;\n    let ctx = canvas.getContext(\"2d\");\n\n    setUp(ctx);\n    drawBoard(ctx, \"#0099FF\", newDrawRegionLeft, newDrawRegionTop, w, h);\n  }, []);\n\n  useEffect(() => {\n    canvas = canvasRef.current;\n    let ctx = canvas.getContext(\"2d\");\n\n    console.log(\"Redrawing...\");\n\n    if (!win) {\n      drawChips(ctx);\n      calculateWin();\n    } else {\n      console.log(\"WINNER\");\n    }\n  }, [drawChips]);\n\n  return (\n    <div className=\"canvas\">\n      <canvas\n        ref={canvasRef}\n        width={canvasWidth}\n        height={canvasHeight}\n        onMouseDown={handleMouseDown}\n        onMouseUp={handleMouseUp}\n      ></canvas>\n      <AwesomeButton type=\"primary\" onPress={() => resetChips()}>\n        Clear Board\n      </AwesomeButton>\n    </div>\n  );\n}\n\nexport default Canvas;\n"]},"metadata":{},"sourceType":"module"}