{"ast":null,"code":"var _jsxFileName = \"/Users/madhavramesh/Desktop/Brown University/Connect 4 React/connect4react/src/Canvas.js\",\n    _s = $RefreshSig$();\n\nimport React, { useRef, useEffect, useState } from \"react\";\nimport { AwesomeButton } from \"react-awesome-button\";\nimport \"react-awesome-button/dist/styles.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Canvas(props) {\n  _s();\n\n  let canvas;\n  const canvasWidth = props.canvasWidth;\n  const canvasHeight = props.canvasHeight;\n  const canvasRef = useRef(null);\n  const drawRegionLeft = props.drawRegionLeft;\n  const drawRegionRight = props.drawRegionRight;\n  const drawRegionTop = props.drawRegionTop;\n  const drawRegionBottom = props.drawRegionBottom;\n  const [chipCoords, setChipCoords] = useState([]);\n  const chipsPerRow = 7;\n  const chipsPerCol = 6;\n  const chipRad = 50;\n  const defaultColor = \"#DCDCDC\";\n  const redChipColor = \"#900000\";\n  const yellowChipColor = \"#fbec5d\";\n  const newDrawRegionLeft = drawRegionLeft - chipRad - 40;\n  const newDrawRegionTop = drawRegionTop - chipRad - 40;\n  const w = drawRegionRight - drawRegionLeft + 2 * (chipRad + 40);\n  const h = drawRegionBottom - drawRegionTop + 2 * (chipRad + 40);\n  const [player, setPlayer] = useState(0);\n  const [mouseX, setMouseX] = useState(0);\n  const [mouseY, setMouseY] = useState(0);\n\n  const setUp = ctx => {\n    ctx.fillStyle = defaultColor;\n    ctx.fillRect(0, 0, canvasWidth, canvasHeight);\n    const newChipCoords = chipCoords; // prettier-ignore\n\n    for (let i = drawRegionLeft; i <= drawRegionRight; i += (drawRegionRight - drawRegionLeft) / (chipsPerRow - 1)) {\n      const row = [];\n\n      for (let j = drawRegionTop; j <= drawRegionBottom; j += (drawRegionBottom - drawRegionTop) / (chipsPerCol - 1)) {\n        row.push([i, j, defaultColor]);\n      }\n\n      newChipCoords.push(row);\n    }\n\n    setChipCoords(newChipCoords);\n  }; // prettier-ignore\n\n\n  const drawBoard = (ctx, color, topLeftX, topLeftY, w, h) => {\n    ctx.fillStyle = color;\n    ctx.fillRect(topLeftX, topLeftY, w, h);\n  };\n\n  const drawChips = ctx => {\n    for (const col of chipCoords) {\n      for (const row of col) {\n        drawChip(ctx, row[2], row[0], row[1], chipRad);\n      }\n    }\n  };\n\n  const drawChip = (ctx, color, x, y) => {\n    ctx.fillStyle = color;\n    ctx.beginPath();\n    ctx.arc(x, y, chipRad, 0, 2 * Math.PI);\n    ctx.fill();\n    ctx.stroke();\n  }; // prettier-ignore\n\n\n  const drop = (chipColor, clickX, clickY) => {\n    const newChipCoords = chipCoords;\n    console.log(newChipCoords);\n    const newDrawRegionRight = newDrawRegionLeft + w;\n    const newDrawRegionBottom = newDrawRegionTop + h;\n\n    for (let i = newDrawRegionLeft; i < newDrawRegionRight; i += (newDrawRegionRight - newDrawRegionLeft) / (chipsPerRow - 1)) {\n      const leftBoundary = i;\n      const rightBoundary = i + (newDrawRegionRight - newDrawRegionLeft) / (chipsPerRow - 1);\n\n      if (clickX >= leftBoundary && clickX < rightBoundary && clickY >= newDrawRegionTop && clickY <= newDrawRegionBottom) {\n        let col = Math.floor((clickX - newDrawRegionLeft) / w * chipsPerRow);\n        let row = chipCoords[col].length - 1;\n\n        for (let j = 0; j < chipCoords[col].length; j++) {\n          if (chipCoords[col][j][2] !== defaultColor) {\n            row = j - 1;\n            break;\n          }\n        }\n\n        if (row >= 0) {\n          newChipCoords[col][row][2] = chipColor;\n        }\n      }\n    }\n\n    setChipCoords(newChipCoords);\n  };\n\n  const mousePosOnCanvas = (x, y) => {\n    const canvas = canvasRef.current;\n    const rect = canvas.getBoundingClientRect();\n    const scaleX = canvas.width / rect.width;\n    const scaleY = canvas.height / rect.height;\n    return {\n      x: (x - rect.left) * scaleX,\n      y: (y - rect.top) * scaleY\n    };\n  };\n\n  const handleMouseDown = event => {\n    event.preventDefault();\n    event.stopPropagation();\n    const mousePos = mousePosOnCanvas(event.clientX, event.clientY);\n    setMouseX(mousePos[\"x\"]);\n    setMouseY(mousePos[\"y\"]);\n  };\n\n  const handleMouseUp = event => {\n    event.preventDefault();\n    event.stopPropagation();\n    const curMousePos = mousePosOnCanvas(event.clientX, event.clientY);\n    const curMouseX = curMousePos[\"x\"];\n    const curMouseY = curMousePos[\"y\"];\n    const dx = curMouseX - mouseX;\n    const dy = curMouseY - mouseY;\n\n    if (dx > 0.1 || dy > 0.1) {\n      return;\n    }\n\n    if (player === 0) {\n      drop(redChipColor, mouseX, mouseY);\n      setPlayer(1);\n    } else if (player === 1) {\n      drop(yellowChipColor, mouseX, mouseY);\n      setPlayer(0);\n    }\n  }; // prettier-ignore\n\n\n  const calculateWin = () => {\n    // vertical win\n    for (let i = 0; i < chipCoords.length; i++) {\n      for (let j = 0; j < chipCoords[i].length - 3; j++) {\n        if (chipCoords[i][j][2] === chipCoords[i][j + 1][2] && chipCoords[i][j + 1][2] === chipCoords[i][j + 2][2] && chipCoords[i][j + 2][2] === chipCoords[i][j + 3][2] && chipCoords[i][j] !== defaultColor && chipCoords[i][j + 1] !== defaultColor && chipCoords[i][j + 2] !== defaultColor && chipCoords[i][j + 3] !== defaultColor) {\n          return true;\n        }\n      }\n    } // horizontal win\n\n\n    for (let i = 0; i < chipCoords.length - 3; i++) {\n      for (let j = 0; j < chipCoords[i].length; j++) {\n        if (chipCoords[i][j][2] === chipCoords[i + 1][j][2] && chipCoords[i + 1][j][2] === chipCoords[i + 2][j][2] && chipCoords[i + 2][j][2] === chipCoords[i + 3][j][2]) {\n          return true;\n        }\n      }\n    } // descending diagonal\n\n\n    for (let i = 3; i < chipCoords.length; i++) {\n      for (let j = 3; j < chipCoords[i].length; j++) {\n        if (chipCoords[i][j][2] === chipCoords[i - 1][j - 1][2] && chipCoords[i - 1][j - 2][2] === chipCoords[i - 2][j - 2][2] && chipCoords[i - 2][j - 2][2] === chipCoords[i - 3][j - 3][2]) {\n          return true;\n        }\n      }\n    } // ascending diagonal\n\n\n    for (let i = 0; i < chipCoords.length - 3; i++) {\n      for (let j = 3; j < chipCoords[i].length; j++) {\n        if (chipCoords[i][j][2] === chipCoords[i + 1][j - 1][2] && chipCoords[i + 1][j - 2][2] === chipCoords[i + 2][j - 2][2] && chipCoords[i + 2][j - 2][2] === chipCoords[i + 3][j - 3][2]) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }; // prettier-ignore\n\n\n  const resetChips = () => {\n    for (let i = drawRegionLeft; i <= drawRegionRight; i += (drawRegionRight - drawRegionLeft) / (chipsPerRow - 1)) {\n      const row = [];\n\n      for (let j = drawRegionTop; j <= drawRegionBottom; j += (drawRegionBottom - drawRegionTop) / (chipsPerCol - 1)) {\n        row.push([i, j, defaultColor]);\n      }\n\n      const newChipCoords = chipCoords;\n      newChipCoords.push(row);\n      setChipCoords(newChipCoords);\n    }\n  };\n\n  useEffect(() => {\n    canvas = canvasRef.current;\n    let ctx = canvas.getContext(\"2d\");\n    setUp(ctx);\n    drawBoard(ctx, \"#0099FF\", newDrawRegionLeft, newDrawRegionTop, w, h);\n  }, []);\n  useEffect(() => {\n    canvas = canvasRef.current;\n    let ctx = canvas.getContext(\"2d\");\n    console.log(\"Redrawing...\");\n    drawChips(ctx);\n\n    if (calculateWin()) {\n      console.log(\"won\");\n    }\n  }, [drawChips]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"canvas\",\n    children: [/*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvasRef,\n      width: canvasWidth,\n      height: canvasHeight,\n      onMouseDown: handleMouseDown,\n      onMouseUp: handleMouseUp\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(AwesomeButton, {\n      type: \"primary\",\n      onPress: () => resetChips(),\n      children: \"Clear Board\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 233,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Canvas, \"NYJ4TKWM0NoSzPq7s6qt2phDjTU=\");\n\n_c = Canvas;\nexport default Canvas;\n\nvar _c;\n\n$RefreshReg$(_c, \"Canvas\");","map":{"version":3,"sources":["/Users/madhavramesh/Desktop/Brown University/Connect 4 React/connect4react/src/Canvas.js"],"names":["React","useRef","useEffect","useState","AwesomeButton","Canvas","props","canvas","canvasWidth","canvasHeight","canvasRef","drawRegionLeft","drawRegionRight","drawRegionTop","drawRegionBottom","chipCoords","setChipCoords","chipsPerRow","chipsPerCol","chipRad","defaultColor","redChipColor","yellowChipColor","newDrawRegionLeft","newDrawRegionTop","w","h","player","setPlayer","mouseX","setMouseX","mouseY","setMouseY","setUp","ctx","fillStyle","fillRect","newChipCoords","i","row","j","push","drawBoard","color","topLeftX","topLeftY","drawChips","col","drawChip","x","y","beginPath","arc","Math","PI","fill","stroke","drop","chipColor","clickX","clickY","console","log","newDrawRegionRight","newDrawRegionBottom","leftBoundary","rightBoundary","floor","length","mousePosOnCanvas","current","rect","getBoundingClientRect","scaleX","width","scaleY","height","left","top","handleMouseDown","event","preventDefault","stopPropagation","mousePos","clientX","clientY","handleMouseUp","curMousePos","curMouseX","curMouseY","dx","dy","calculateWin","resetChips","getContext"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect, useState } from \"react\";\nimport { AwesomeButton } from \"react-awesome-button\";\nimport \"react-awesome-button/dist/styles.css\";\n\nfunction Canvas(props) {\n  let canvas;\n  const canvasWidth = props.canvasWidth;\n  const canvasHeight = props.canvasHeight;\n  const canvasRef = useRef(null);\n\n  const drawRegionLeft = props.drawRegionLeft;\n  const drawRegionRight = props.drawRegionRight;\n  const drawRegionTop = props.drawRegionTop;\n  const drawRegionBottom = props.drawRegionBottom;\n\n  const [chipCoords, setChipCoords] = useState([]);\n  const chipsPerRow = 7;\n  const chipsPerCol = 6;\n  const chipRad = 50;\n\n  const defaultColor = \"#DCDCDC\";\n  const redChipColor = \"#900000\";\n  const yellowChipColor = \"#fbec5d\";\n\n  const newDrawRegionLeft = drawRegionLeft - chipRad - 40;\n  const newDrawRegionTop = drawRegionTop - chipRad - 40;\n  const w = drawRegionRight - drawRegionLeft + 2 * (chipRad + 40);\n  const h = drawRegionBottom - drawRegionTop + 2 * (chipRad + 40);\n\n  const [player, setPlayer] = useState(0);\n  const [mouseX, setMouseX] = useState(0);\n  const [mouseY, setMouseY] = useState(0);\n\n  const setUp = (ctx) => {\n    ctx.fillStyle = defaultColor;\n    ctx.fillRect(0, 0, canvasWidth, canvasHeight);\n\n    const newChipCoords = chipCoords;\n    // prettier-ignore\n    for (let i = drawRegionLeft; i <= drawRegionRight; i += (drawRegionRight - drawRegionLeft) / (chipsPerRow - 1)) {\n      const row = [];\n      for (let j = drawRegionTop; j <= drawRegionBottom; j += (drawRegionBottom - drawRegionTop) / (chipsPerCol - 1)) {\n        row.push([i, j, defaultColor]);\n      }\n      newChipCoords.push(row);\n    }\n    setChipCoords(newChipCoords);\n  };\n\n  // prettier-ignore\n  const drawBoard = (ctx, color, topLeftX, topLeftY, w, h) => {\n    ctx.fillStyle = color;\n    ctx.fillRect(topLeftX, topLeftY, w, h);\n  };\n\n  const drawChips = (ctx) => {\n    for (const col of chipCoords) {\n      for (const row of col) {\n        drawChip(ctx, row[2], row[0], row[1], chipRad);\n      }\n    }\n  };\n\n  const drawChip = (ctx, color, x, y) => {\n    ctx.fillStyle = color;\n    ctx.beginPath();\n    ctx.arc(x, y, chipRad, 0, 2 * Math.PI);\n    ctx.fill();\n    ctx.stroke();\n  };\n\n  // prettier-ignore\n  const drop = (chipColor, clickX, clickY) => {\n    const newChipCoords = chipCoords;\n    console.log(newChipCoords);\n\n    const newDrawRegionRight = newDrawRegionLeft + w;\n    const newDrawRegionBottom = newDrawRegionTop + h;\n\n    for (let i = newDrawRegionLeft; i < newDrawRegionRight; i += (newDrawRegionRight - newDrawRegionLeft) / (chipsPerRow - 1)) {\n      const leftBoundary = i;\n      const rightBoundary = i + (newDrawRegionRight - newDrawRegionLeft) / (chipsPerRow - 1);\n      if (clickX >= leftBoundary && clickX < rightBoundary && clickY >= newDrawRegionTop && clickY <= newDrawRegionBottom) {\n        let col = Math.floor((clickX - newDrawRegionLeft) / w * chipsPerRow);\n        let row = chipCoords[col].length - 1;\n\n        for (let j = 0; j < chipCoords[col].length; j++) {\n          if (chipCoords[col][j][2] !== defaultColor) {\n            row = j - 1;\n            break;\n          }\n        }\n        if (row >= 0) {\n          newChipCoords[col][row][2] = chipColor;\n        }\n      }\n    }\n    setChipCoords(newChipCoords);\n  };\n\n  const mousePosOnCanvas = (x, y) => {\n    const canvas = canvasRef.current;\n    const rect = canvas.getBoundingClientRect();\n    const scaleX = canvas.width / rect.width;\n    const scaleY = canvas.height / rect.height;\n\n    return {\n      x: (x - rect.left) * scaleX,\n      y: (y - rect.top) * scaleY,\n    };\n  };\n\n  const handleMouseDown = (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    const mousePos = mousePosOnCanvas(event.clientX, event.clientY);\n    setMouseX(mousePos[\"x\"]);\n    setMouseY(mousePos[\"y\"]);\n  };\n\n  const handleMouseUp = (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    const curMousePos = mousePosOnCanvas(event.clientX, event.clientY);\n    const curMouseX = curMousePos[\"x\"];\n    const curMouseY = curMousePos[\"y\"];\n    const dx = curMouseX - mouseX;\n    const dy = curMouseY - mouseY;\n\n    if (dx > 0.1 || dy > 0.1) {\n      return;\n    }\n\n    if (player === 0) {\n      drop(redChipColor, mouseX, mouseY);\n      setPlayer(1);\n    } else if (player === 1) {\n      drop(yellowChipColor, mouseX, mouseY);\n      setPlayer(0);\n    }\n  };\n\n  // prettier-ignore\n  const calculateWin = () => {\n    // vertical win\n    for (let i = 0; i < chipCoords.length; i++) {\n      for (let j = 0; j < chipCoords[i].length - 3; j++) {\n        if (chipCoords[i][j][2] === chipCoords[i][j + 1][2]\n        && chipCoords[i][j + 1][2] === chipCoords[i][j + 2][2]\n        && chipCoords[i][j + 2][2] === chipCoords[i][j + 3][2]\n        && chipCoords[i][j] !== defaultColor\n        && chipCoords[i][j + 1] !== defaultColor\n        && chipCoords[i][j + 2] !== defaultColor\n        && chipCoords[i][j + 3] !== defaultColor) {\n          return true;\n        }\n      }\n    }\n\n    // horizontal win\n    for (let i = 0; i < chipCoords.length - 3; i++) {\n      for (let j = 0; j < chipCoords[i].length; j++) {\n        if (chipCoords[i][j][2] === chipCoords[i+1][j][2]\n            && chipCoords[i+1][j][2] === chipCoords[i+2][j][2]\n            && chipCoords[i+2][j][2] === chipCoords[i+3][j][2]) {\n          return true;\n        }\n      }\n    }\n\n    // descending diagonal\n    for (let i = 3; i < chipCoords.length; i++) {\n      for (let j = 3; j < chipCoords[i].length; j++) {\n        if (chipCoords[i][j][2] === chipCoords[i-1][j-1][2]\n            && chipCoords[i-1][j-2][2] === chipCoords[i-2][j-2][2]\n            && chipCoords[i-2][j-2][2] === chipCoords[i-3][j-3][2]) {\n          return true;\n        }\n      }\n    }\n\n    // ascending diagonal\n    for (let i = 0; i < chipCoords.length - 3; i++) {\n      for (let j = 3; j < chipCoords[i].length; j++) {\n        if (chipCoords[i][j][2] === chipCoords[i+1][j-1][2]\n            && chipCoords[i+1][j-2][2] === chipCoords[i+2][j-2][2]\n            && chipCoords[i+2][j-2][2] === chipCoords[i+3][j-3][2]) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  // prettier-ignore\n  const resetChips = () => {\n    for (let i = drawRegionLeft; i <= drawRegionRight; i += (drawRegionRight - drawRegionLeft) / (chipsPerRow - 1)) {\n      const row = [];\n      for (let j = drawRegionTop; j <= drawRegionBottom; j += (drawRegionBottom - drawRegionTop) / (chipsPerCol - 1)) {\n        row.push([i, j, defaultColor]);\n      }\n      const newChipCoords = chipCoords;\n      newChipCoords.push(row);\n      setChipCoords(newChipCoords);\n    }\n  };\n\n  useEffect(() => {\n    canvas = canvasRef.current;\n    let ctx = canvas.getContext(\"2d\");\n\n    setUp(ctx);\n    drawBoard(ctx, \"#0099FF\", newDrawRegionLeft, newDrawRegionTop, w, h);\n  }, []);\n\n  useEffect(() => {\n    canvas = canvasRef.current;\n    let ctx = canvas.getContext(\"2d\");\n\n    console.log(\"Redrawing...\");\n\n    drawChips(ctx);\n\n    if (calculateWin()) {\n      console.log(\"won\");\n    }\n  }, [drawChips]);\n\n  return (\n    <div className=\"canvas\">\n      <canvas\n        ref={canvasRef}\n        width={canvasWidth}\n        height={canvasHeight}\n        onMouseDown={handleMouseDown}\n        onMouseUp={handleMouseUp}\n      ></canvas>\n      <AwesomeButton type=\"primary\" onPress={() => resetChips()}>\n        Clear Board\n      </AwesomeButton>\n    </div>\n  );\n}\n\nexport default Canvas;\n"]},"metadata":{},"sourceType":"module"}